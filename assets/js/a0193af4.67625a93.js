"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[5076],{5846:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>p,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var s=r(6070),a=r(8355);const i={sidebar_position:2},t=void 0,o={id:"docs/template/react-mp/\u5de5\u7a0b\u8bf4\u660e",title:"\u5de5\u7a0b\u8bf4\u660e",description:"\u6a21\u677f\u5de5\u7a0b\u5f00\u53d1\u7406\u5ff5",source:"@site/docs/docs/template/react-mp/\u5de5\u7a0b\u8bf4\u660e.md",sourceDirName:"docs/template/react-mp",slug:"/docs/template/react-mp/\u5de5\u7a0b\u8bf4\u660e",permalink:"/docs/3.0/docs/template/react-mp/\u5de5\u7a0b\u8bf4\u660e",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"\u6587\u4ef6\u76ee\u5f55",permalink:"/docs/3.0/docs/template/react-mp/\u6587\u4ef6\u76ee\u5f55"},next:{title:"React-SP",permalink:"/docs/3.0/category/react-sp"}},l={},d=[{value:"\u6a21\u677f\u5de5\u7a0b\u5f00\u53d1\u7406\u5ff5",id:"\u6a21\u677f\u5de5\u7a0b\u5f00\u53d1\u7406\u5ff5",level:2},{value:"\u6a21\u677f\u5de5\u7a0b\u89e3\u51b3\u7684\u95ee\u9898",id:"\u6a21\u677f\u5de5\u7a0b\u89e3\u51b3\u7684\u95ee\u9898",level:2},{value:"app\u4ea4\u4e92\u914d\u7f6e\u3001\u6d4f\u89c8\u5668\u7aef\u914d\u7f6e\u6807\u51c6\u5316",id:"app\u4ea4\u4e92\u914d\u7f6e\u6d4f\u89c8\u5668\u7aef\u914d\u7f6e\u6807\u51c6\u5316",level:3},{value:"\u521b\u5efa\u81ea\u5df1\u9875\u9762",id:"\u521b\u5efa\u81ea\u5df1\u9875\u9762",level:2},{value:"\u539f\u751fapp\u5185\u5d4c\u9875\u9762\u4ea4\u4e92\u4e0e\u7eaf\u6d4f\u89c8\u5668\u8bbf\u95ee\u9875\u9762",id:"\u539f\u751fapp\u5185\u5d4c\u9875\u9762\u4ea4\u4e92\u4e0e\u7eaf\u6d4f\u89c8\u5668\u8bbf\u95ee\u9875\u9762",level:2},{value:"redux\u72b6\u6001\u7ba1\u7406",id:"redux\u72b6\u6001\u7ba1\u7406",level:2},{value:"\u4e3a\u4ec0\u4e48\u4ecd\u7136\u7ee7\u7eed\u4f7f\u7528\u5570\u55e6\u7684redux",id:"\u4e3a\u4ec0\u4e48\u4ecd\u7136\u7ee7\u7eed\u4f7f\u7528\u5570\u55e6\u7684redux",level:3},{value:"\u6807\u51c6store\u57fa\u672c\u7ed3\u6784",id:"\u6807\u51c6store\u57fa\u672c\u7ed3\u6784",level:3},{value:"\u521b\u5efa\u81ea\u5df1\u9875\u9762\u7684\u72b6\u6001",id:"\u521b\u5efa\u81ea\u5df1\u9875\u9762\u7684\u72b6\u6001",level:3},{value:"\u7f51\u7edc\u8bf7\u6c42",id:"\u7f51\u7edc\u8bf7\u6c42",level:2},{value:"dz-axios",id:"dz-axios",level:3},{value:"dz-axios\u4e2d\u95f4\u4ef6",id:"dz-axios\u4e2d\u95f4\u4ef6",level:4},{value:"react query",id:"react-query",level:3},{value:"react query\u7684\u4f18\u70b9",id:"react-query\u7684\u4f18\u70b9",level:4},{value:"\u5728\u9879\u76ee\u4e2d\u4f7f\u7528react query",id:"\u5728\u9879\u76ee\u4e2d\u4f7f\u7528react-query",level:4},{value:"\u591a\u8bed\u8a00\u56fd\u9645\u5316",id:"\u591a\u8bed\u8a00\u56fd\u9645\u5316",level:2},{value:"vscode\u591a\u8bed\u8a00\u63d2\u4ef6",id:"vscode\u591a\u8bed\u8a00\u63d2\u4ef6",level:3},{value:"\u591a\u8bed\u8a00\u914d\u7f6e\u6587\u4ef6\u7ed3\u6784",id:"\u591a\u8bed\u8a00\u914d\u7f6e\u6587\u4ef6\u7ed3\u6784",level:3},{value:"\u5982\u4f55\u4fdd\u6301\u9879\u76ee\u4e0e\u6a21\u677f\u5de5\u7a0b\u7684\u540c\u6b65",id:"\u5982\u4f55\u4fdd\u6301\u9879\u76ee\u4e0e\u6a21\u677f\u5de5\u7a0b\u7684\u540c\u6b65",level:3}];function c(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"\u6a21\u677f\u5de5\u7a0b\u5f00\u53d1\u7406\u5ff5",children:"\u6a21\u677f\u5de5\u7a0b\u5f00\u53d1\u7406\u5ff5"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u8ba9\u5f00\u53d1\u91cd\u65b0\u5173\u6ce8\u81ea\u5df1\u6b63\u5728\u5f00\u53d1\u7684\u9875\u9762\u800c\u4e0d\u662f\u522b\u4eba\u5199\u7684bug"}),"\n",(0,s.jsx)(n.li,{children:"\u591a\u7aef\u590d\u7528\u4ee3\u7801"}),"\n",(0,s.jsx)(n.li,{children:"react-query\u4f18\u5148"}),"\n",(0,s.jsx)(n.li,{children:"\u6807\u51c6\u5316\u7f51\u7edc\u8bf7\u6c42(dz-axios)"}),"\n",(0,s.jsx)(n.li,{children:"\u63d0\u5347\u5f00\u53d1\u8c03\u8bd5\u6548\u7387"}),"\n",(0,s.jsx)(n.li,{children:"\u4fdd\u6301\u9879\u76ee\u4e0e\u6a21\u677f\u5de5\u7a0b\u8fed\u4ee3\u7684\u540c\u6b65"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\u6a21\u677f\u5de5\u7a0b\u89e3\u51b3\u7684\u95ee\u9898",children:"\u6a21\u677f\u5de5\u7a0b\u89e3\u51b3\u7684\u95ee\u9898"}),"\n",(0,s.jsx)(n.p,{children:"\u672c\u6a21\u677f\u9879\u76ee\u4e3b\u8981\u89e3\u51b3\u516c\u53f8\u524d\u7aef\u5f00\u53d1\u4e2d\u9047\u5230\u7684\u5e38\u89c1\u95ee\u9898\uff0c\u8ba9\u5f00\u53d1\u5c3d\u91cf\u53ea\u5173\u6ce8\u81ea\u5df1\u6b63\u5728\u5f00\u53d1\u7684\u9875\u9762\uff0c\u9875\u9762\u4e4b\u5916\u7684\u4ee3\u7801\u6807\u51c6\u5316, \u7edf\u4e00\u7531\u6a21\u677f\u5de5\u7a0b\u7ef4\u62a4\uff0c\u901a\u8fc7git cherry-pick\u9009\u62e9\u6027\u66f4\u65b0\u5230\u81ea\u5df1\u7684\u9879\u76ee\u4e2d\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"app\u4ea4\u4e92\u914d\u7f6e\u6d4f\u89c8\u5668\u7aef\u914d\u7f6e\u6807\u51c6\u5316",children:"app\u4ea4\u4e92\u914d\u7f6e\u3001\u6d4f\u89c8\u5668\u7aef\u914d\u7f6e\u6807\u51c6\u5316"}),"\n",(0,s.jsx)(n.p,{children:"\u4e1a\u52a1\u4ee3\u7801\u4e2d\u53ea\u9700\u8981\u4eceredux\u4e2d\u8bfb\u53d6\u914d\u7f6e\u3002\u6ce8\u610f\u9700\u8981\u5bf9\u63a5\u4e00\u6b21\u539f\u751f\u4ea4\u4e92\uff0c\u5728pc\u6216mobile\u4e2d\u7684customize.ts\u6587\u4ef6\u5728\u6839\u636e\u9879\u76ee\u4e0d\u540c\uff0c\u5b9a\u4e49\u597d\u5f53\u524d\u4ea4\u4e92\u7684\u7c7b\u578b\uff0c\u8fdb\u884c\u4e00\u6b21\u6570\u636e\u8f6c\u6362\uff0c\u8f6c\u6362\u4e3aredux\u4e2d\u7684\u6807\u51c6\u914d\u7f6e, \u8fd8\u9700\u8981\u5728\u76f8\u5e94\u7aef\u7684msg.ts\u4e2d\u4fee\u6539getUserConfig, getUserInfo\u65b9\u6cd5\uff0c\u9ed8\u8ba4\u9002\u914d\u4e86\u4e2d\u4fe1(\u4e2d\u4fe1\u3001\u5149\u8bc1)\u624b\u673a\u3001pc\u5ba2\u6237\u7aef\u3002\n\u624b\u673a\u7aef\u7684\u9875\u9762\uff0c\u4e0d\u9700\u8981\u5173\u5fc3\u8fd0\u884c\u5728\u54ea\u4e2a\u7aef\uff0c\u5982\u679c\u6ca1\u6709\u4f9d\u8d56app\u4ea4\u4e92\uff0c\u662f\u53ef\u4ee5\u540c\u65f6\u8fd0\u884c\u5728\u539f\u751f\u3001\u6d4f\u89c8\u5668\u4e2d\u7684\u3002\u539f\u751f\u4ea4\u4e92\u9694\u79bb\uff0c\u53ef\u4f7f\u7528\u539f\u6709\u7684multi-platforms.ts\u63d0\u4f9b\u4e0d\u540c\u5e73\u53f0\u76f8\u540c\u540d\u5b57\u7684api"}),"\n",(0,s.jsx)(n.h2,{id:"\u521b\u5efa\u81ea\u5df1\u9875\u9762",children:"\u521b\u5efa\u81ea\u5df1\u9875\u9762"}),"\n",(0,s.jsx)(n.p,{children:"\u8fd0\u884cpackage.json\u4e2d\u7684create-page\u547d\u4ee4\uff0c\u6839\u636e\u63d0\u793a\u56de\u7b54\u95ee\u9898\uff0c\u5373\u53ef\u521b\u5efa\u81ea\u5df1\u7684\u9875\u9762\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"pnpm create-page\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u539f\u751fapp\u5185\u5d4c\u9875\u9762\u4ea4\u4e92\u4e0e\u7eaf\u6d4f\u89c8\u5668\u8bbf\u95ee\u9875\u9762",children:"\u539f\u751fapp\u5185\u5d4c\u9875\u9762\u4ea4\u4e92\u4e0e\u7eaf\u6d4f\u89c8\u5668\u8bbf\u95ee\u9875\u9762"}),"\n",(0,s.jsx)(n.p,{children:"\u53c2\u8003esboot\u5728.env\u4e2d\u6253\u5305\u51fa\u4e0d\u540c\u7aef\u7684\u9875\u9762\u5373\u53ef, \u4e3a\u907f\u514d\u9690\u85cfbug\u8fc7\u591a\uff0c\u8981\u4e25\u683c\u533a\u5206\u539f\u751f\u7aef\u3001\u6d4f\u89c8\u5668\u7aef\uff0c\u4e0d\u53ef\u5171\u7528\u540c\u4e00\u4e2a\u5305\u90e8\u7f72\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"redux\u72b6\u6001\u7ba1\u7406",children:"redux\u72b6\u6001\u7ba1\u7406"}),"\n",(0,s.jsx)(n.p,{children:"\u6bcf\u4e2a\u9875\u9762\uff0c\u90fd\u5e26\u6709\u4e00\u4e2a\u5982\u4e0b\u56fe\u7684\u6807\u51c6\u5316userConfig\uff0cpc\u7aef\u3001\u624b\u673a\u7aef\u4e0d\u4e00\u6837\uff0c\u4f46\u624b\u673a\u7aef\u5728app\u5185\u6216\u6d4f\u89c8\u5668\u4e0a\u90fd\u662f\u6807\u51c6\u7684\u4e00\u5957\uff0cpc\u7aef\u540c\u7406\u3002userInfo\u4e0d\u662f\u6807\u51c6\u7684\uff0c\u6839\u636e\u9879\u76ee\u4e0d\u540c\uff0c\u9700\u8981\u81ea\u5df1\u5728\u76f8\u5e94\u7aef\u7684customize.ts\u6587\u4ef6\u4e2d\u4fee\u6539IRawAppUserConfig\u7684\u7c7b\u578b\u5b9a\u4e49\u3002oldStyle2Standard\u51fd\u6570\u4e2d\u8f6c\u6362\u5316\u6807\u51c6\u7684userConfig\u3002\u8fd9\u5c31\u662f\u5bf9\u63a5\u65b0\u7684\u4ea4\u4e92\u9700\u8981\u505a\u7684\u5927\u90e8\u5206\u5de5\u4f5c(msg\u4e2d\u8fd8\u9700\u8981\u4fee\u6539\u539f\u751fgetUserConfig\u7684\u4ea4\u4e92\u540d\u79f0)\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"\u6807\u51c6redux app\u914d\u7f6e",src:r(1569).A+"",width:"1373",height:"431"})}),"\n",(0,s.jsx)(n.h3,{id:"\u4e3a\u4ec0\u4e48\u4ecd\u7136\u7ee7\u7eed\u4f7f\u7528\u5570\u55e6\u7684redux",children:"\u4e3a\u4ec0\u4e48\u4ecd\u7136\u7ee7\u7eed\u4f7f\u7528\u5570\u55e6\u7684redux"}),"\n",(0,s.jsx)(n.p,{children:"redux toolkit\u5e76\u4e0d\u7b97\u5570\u55e6\uff0c\u4f7f\u7528\u7b80\u5355\uff0c\u4eba\u4eba\u90fd\u4f1a, \u800c\u4e14redux\u7684\u8c03\u8bd5\u5de5\u5177\u4f9d\u7136\u662f\u6700\u65b9\u4fbf\u7684\uff0c\u7a0d\u5fae\u9ebb\u70e6\u4e00\u70b9\uff0c\u540e\u7eed\u7ef4\u62a4\u3001\u67e5bug\u90fd\u80fd\u8282\u7ea6\u81ea\u5df1\u3001\u4ed6\u4eba\u7684\u5927\u91cf\u5f00\u53d1\u65f6\u95f4\u3002\u6709\u4e86react query\u4e4b\u540e\uff0c\u9664\u4e86app\u8bbe\u7f6e\u3001\u7528\u6237\u4fe1\u606f\u3001\u4ea4\u6613\u8bbe\u7f6e\uff0c\u7edd\u5927\u591a\u6570\u4e1a\u52a1\u573a\u666f\u90fd\u7528\u4e0d\u5230redux, \u6240\u4ee5\u63a8\u8350\u5927\u5bb6\u4f7f\u7528react query\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"\u6807\u51c6store\u57fa\u672c\u7ed3\u6784",children:"\u6807\u51c6store\u57fa\u672c\u7ed3\u6784"}),"\n",(0,s.jsx)(n.p,{children:"\u79fb\u52a8\u7aef"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"export interface IStandardAppUserConfig {\n  theme: ThemeValues;\n  language: Language;\n  raise: RaiseMode;\n  /**\n   * \u8ddf\u968f\u7cfb\u7edf\u989c\u8272\u6a21\u5f0f\n   */\n  followSystemPrefersColorSchemeWhenInBrowser: boolean;\n  deviceNo: string;\n  raw: IRawAppUserConfig;\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"pc\u7aef"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"export interface IStandardAppUserConfig {\n  theme: ThemeValues;\n  language: Language;\n  raise: RaiseMode;\n  /**\n   * \u8ddf\u968f\u7cfb\u7edf\u989c\u8272\u6a21\u5f0f\n   */\n  followSystemPrefersColorSchemeWhenInBrowser: boolean;\n  deviceNo: string;\n  appFontSize: number;\n  appFontWeight: 'normal' | 'bold';\n  raw: IRawAppUserConfig;\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u521b\u5efa\u81ea\u5df1\u9875\u9762\u7684\u72b6\u6001",children:"\u521b\u5efa\u81ea\u5df1\u9875\u9762\u7684\u72b6\u6001"}),"\n",(0,s.jsx)(n.p,{children:"\u81ea\u5df1\u9875\u9762\u76ee\u5f55\u4e0b\uff0c\u6709\u81ea\u5df1\u7684model\uff0c\u521b\u5efa\u9875\u9762\u65f6\u4f1a\u9644\u5e26\u4e00\u4e2ahello\u6a21\u5757redux toolkit slice\u7684\u4f8b\u5b50\uff0c\u53ef\u4ee5\u53c2\u8003hello\u6a21\u5757\u7684\u5199\u6cd5\u4fee\u6539\u4e00\u4e0b\u5373\u53ef\u3002redux\u4e2d\u7684\u6570\u636e\u5e76\u4e0d\u4f1a\u88ab\u91ca\u653e\uff0c\u6c38\u8fdc\u5728\u5185\u5b58\u4e2d\uff0c\u6240\u4ee5\u4e0d\u8981\u5b58\u653e\u5927\u91cf\u6570\u636e\uff0c\u53ea\u5b58\u653e\u4e00\u4e9b\u914d\u7f6e\u4fe1\u606f\uff0c\u6216\u8005\u4e00\u4e9b\u9700\u8981\u8de8\u9875\u9762\u5171\u4eab\u7684\u6570\u636e\u3002\u80fd\u7528react query\u5c31\u7528react query\uff0c\u4e0d\u8981\u8fc7\u6e21\u4f7f\u7528redux\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"\u7f51\u7edc\u8bf7\u6c42",children:"\u7f51\u7edc\u8bf7\u6c42"}),"\n",(0,s.jsx)(n.h3,{id:"dz-axios",children:"dz-axios"}),"\n",(0,s.jsxs)(n.p,{children:["\u7f51\u7edc\u8bf7\u6c42\u4f7f\u7528\u6839\u636e\u516c\u53f8\u5e38\u89c1\u4e1a\u52a1\u5c01\u88c5\u597d\u7684dz-axios\uff0c\u7b80\u5355\u5b66\u4e60\uff0c\u4ece\u590d\u6742\u6df7\u4e71\u7684\u7f51\u7edc\u8bf7\u6c42\u4e2d\u89e3\u653e\u51fa\u6765\uff0c\u4e13\u6ce8\u4e8e\u4e1a\u52a1\u5f00\u53d1\u3002",(0,s.jsx)(n.a,{href:"http://git.web.dz/WebTeam/common-library/dz-network",children:"dz-axios\u6587\u6863"}),", \u9879\u76ee\u4e2d\u9644\u5e26\u4e86\u4e00\u4e2a\u7f51\u7edc\u8bf7\u6c42\u7684\u4f8b\u5b50\uff0c\u53ef\u4ee5\u53c2\u8003\u3002"]}),"\n",(0,s.jsx)(n.h4,{id:"dz-axios\u4e2d\u95f4\u4ef6",children:"dz-axios\u4e2d\u95f4\u4ef6"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"globalBlocker"})," \u7528\u4e8e\u7b49\u5f85\u83b7\u53d6\u5230app\u4e2d\u7684\u767b\u5f55token\u518d\u53d1\u9001\u7f51\u7edc\u8bf7\u6c42\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"createBasicPatternMiddleware"})," \u5c01\u88c5\u4e86\u5e38\u89c1\u7684\u4e1a\u52a1\u573a\u666f\uff0c\u80fd\u6ee1\u8db3\u57fa\u672c\u7684\u4e1a\u52a1\u573a\u666f\uff0c\u5982\u6709\u7279\u6b8a\u9700\u6c42\uff0c\u53ef\u4ee5\u53c2\u8003\u6587\u6863\u793a\u4f8b\u81ea\u5df1\u521b\u5efa\u4e00\u4e2a\u4e2d\u95f4\u4ef6\u5373\u53ef\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"createEncryptedGatewayMiddleware"})," \u7528\u4e8e\u4ea4\u6613\u7f51\u5173\u7684\u52a0\u89e3\u5bc6\u8bf7\u6c42\uff0c\u5982\u679c\u4e0d\u9700\u8981\u52a0\u89e3\u5bc6\uff0c\u53ef\u4ee5\u4e0d\u4f7f\u7528\u3002"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"@dz-web/axios-middlewares\u4e2d\u63d0\u4f9b\u4e86\u4e00\u4e9b\u5e38\u7528\u7684\u4e2d\u95f4\u4ef6\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\uff0c\u4e5f\u53ef\u4ee5\u53c2\u8003\u81ea\u5df1\u5199\u4e00\u4e9b\u4e2d\u95f4\u4ef6\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u5982\u4e0b\u662f\u5149\u8bc1\u4ea4\u6613\u9879\u76ee\u4e2d\u7684java\u63a5\u53e3\u5171\u7528\u7684axios instance\u793a\u4f8b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { createDZAxiosInstance } from '@dz-web/axios';\nimport axios from 'axios';\nimport { createBasicPatternMiddleware, globalBlocker } from '@dz-web/axios-middlewares';\nimport { logout } from '@/utils/logout';\nimport { getPlatformIndependentUserConfig } from '@/utils/platfom-indepent/user-config';\nimport { IJavaAPICommonResponse } from './types';\nimport { isExpired } from './favorite-stocks/codes';\n\nconst isBusinessError = (data: IJavaAPICommonResponse) => data.code !== 0;\nconst baseURL = window.GLOBAL_CONFIG.COMMON_SERVERS.commonServer;\n\nexport const authedCommonJavaInst = createDZAxiosInstance(() => axios.create({\n  baseURL,\n}), [\n  globalBlocker.middleware,\n  createBasicPatternMiddleware({\n    addHeaders: () => {\n      const { language, token } = getPlatformIndependentUserConfig();\n      return {\n        Token: token,\n        'Accept-Language': language,\n      };\n    },\n    isBusinessError,\n    onBusinessError: (data) => {\n      if (isExpired(data.code)) {\n        logout({\n          code: data.code,\n          message: data.message,\n        });\n      }\n    },\n  }),\n]);\n\nexport const commonJavaInst = createDZAxiosInstance(() => axios.create({\n  baseURL,\n}), [\n  createBasicPatternMiddleware({\n    addHeaders: () => {\n      const { language } = getPlatformIndependentUserConfig();\n      return {\n        'Accept-Language': language,\n      };\n    },\n    isBusinessError,\n  }),\n]);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5982\u4e0b\u662f\u5149\u8bc1\u4ea4\u6613\u9879\u76ee\u4e2d\u7684\u4ea4\u6613\u63a5\u53e3\u4f7f\u7528\u7684axios instance\u793a\u4f8b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import axios from 'axios';\nimport { createDZAxiosInstance } from '@dz-web/axios';\nimport { createBasicPatternMiddleware, globalBlocker,\n  createEncryptedGatewayMiddleware } from '@dz-web/axios-middlewares';\nimport { logout } from '@/utils/logout';\nimport { getPlatformIndependentUserConfig } from '@/utils/platfom-indepent/user-config';\nimport { ITradeAPIResponse } from './api';\nimport { initEncryptKey } from './encrypt-api';\nimport { publicKey } from '../../constants/trade/public-key';\nimport { isExpired } from './codes';\n\nconst isBusinessError = (data: ITradeAPIResponse) => data.code !== 0;\n\nconst baseURL = window.GLOBAL_CONFIG.COMMON_SERVERS.commonServer;\n\nexport const encryptor = createEncryptedGatewayMiddleware({\n  fetchKey: async (postKey: string) => initEncryptKey(baseURL, postKey),\n  publicKey,\n});\n\n/**\n * \u9700\u8981\u767b\u5f55\u7684\u8bf7\u6c42\u4f7f\u7528\u8fd9\u4e2aaxios\u5b9e\u4f8b\n */\nexport const authedTradeAxiosInst = createDZAxiosInstance(() => axios.create({\n  baseURL,\n}), [\n  globalBlocker.middleware,\n  ...(window.GLOBAL_CONFIG.ENABLE_ENCRYPT ? encryptor.middlewares : []),\n  createBasicPatternMiddleware({\n    addHeaders: () => {\n      const { language, token } = getPlatformIndependentUserConfig();\n      return {\n        Token: token,\n        'Accept-Language': language,\n      };\n    },\n    isBusinessError,\n    // \u6b63\u5e38\u8fd4\u56de\uff0c\u4f46\u4e1a\u52a1code\u6307\u793a\u4e3a\u975e0\uff0c\u4e1a\u52a1\u9519\u8bef\n    onBusinessError: (data) => {\n      if (isExpired(data.code)) {\n        logout({\n          code: data.code,\n          message: data.message,\n        });\n      }\n    },\n    // \u975e2xx\u8bf7\u6c42\uff0c\u6216\u7f51\u7edc\u9519\u8bef\n    onFatalError(error, res) {\n      if (res.status === 401) {\n        logout({\n          code: 76,\n          message: res.statusText,\n        });\n      }\n    },\n  }),\n]);\n\n/**\n * \u4e0d\u9700\u8981\u767b\u5f55\u7684\u8bf7\u6c42\u4f7f\u7528\u8fd9\u4e2aaxios\u5b9e\u4f8b\n */\nexport const tradeAxiosInst = createDZAxiosInstance(() => axios.create({\n  baseURL,\n}), [\n  ...(window.GLOBAL_CONFIG.ENABLE_ENCRYPT ? encryptor.middlewares : []),\n  createBasicPatternMiddleware({\n    addHeaders: () => {\n      const { language } = getPlatformIndependentUserConfig();\n      return {\n        'Accept-Language': language,\n      };\n    },\n    isBusinessError,\n  }),\n]);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"react-query",children:"react query"}),"\n",(0,s.jsx)(n.p,{children:"\u4e3a\u4e86\u65b9\u4fbf\u7f51\u7edc\u91cd\u8bd5\u3001\u53ef\u9009\u7edf\u4e00\u62a5\u9519\uff0c\u7b80\u5316\u8bf7\u6c42\u4ee3\u7801\u3001\u63d0\u5347\u7528\u6237\u4f53\u9a8c\uff0c\u5927\u5bb6\u9700\u8981\u5c3d\u91cf\u4f7f\u7528react query\u8fdb\u884c\u8bf7\u6c42\u7ba1\u7406\u3002\u5c3d\u91cf\u4e0d\u8981\u81ea\u5df1\u5199\u8bf7\u6c42\u4ee3\u7801\uff0c\u9664\u975e\u6709\u7279\u6b8a\u9700\u6c42\uff0c\u8fd9\u6837\u53ea\u4f1a\u9690\u85cf\u66f4\u591a\u7684bug\u3001\u964d\u4f4e\u7528\u6237\u4f53\u9a8c\u3001\u66f4\u5e9e\u5927\u7684\u4ee3\u7801\u91cf\u3001\u589e\u52a0\u540e\u7eed\u9879\u76ee\u4ea4\u63a5\u7684\u96be\u5ea6\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"react-query\u7684\u4f18\u70b9",children:"react query\u7684\u4f18\u70b9"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4ee3\u7801\u98ce\u683c\u4e00\u81f4"}),"\n",(0,s.jsx)(n.li,{children:"\u5929\u7136\u7f13\u5b58\u3001\u66f4\u4f18\u7684\u7528\u6237\u4f53\u9a8c\u3001\u652f\u6301\u7f13\u5b58\u6570\u636egc\u56de\u6536\u8282\u7ea6\u5185\u5b58"}),"\n",(0,s.jsx)(n.li,{children:"\u7b80\u5355\u914d\u7f6e\u5373\u53ef\u5b9e\u73b0\u591a\u79cd\u591a\u6837\u7684\u7f51\u7edc\u6570\u636e\u5237\u65b0\u573a\u666f"}),"\n",(0,s.jsx)(n.li,{children:"\u53d6\u4ee3\u5927\u90e8\u5206redux\u7684\u573a\u666f\uff0c\u51cf\u5c11redux\u7684\u4f7f\u7528\uff0c\u51cf\u5c11redux\u7684\u4ee3\u7801\u91cf"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"\u5728\u9879\u76ee\u4e2d\u4f7f\u7528react-query",children:"\u5728\u9879\u76ee\u4e2d\u4f7f\u7528react query"}),"\n",(0,s.jsx)(n.p,{children:"\u9879\u76ee\u4e2d\u5df2\u7ecf\u96c6\u6210\u4e86react query v5\u7248\u672c\u3001react query dev tool\u8c03\u8bd5\u5de5\u5177\uff0c\u6b63\u5e38\u4f7f\u7528\u5373\u53ef\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"\u591a\u8bed\u8a00\u56fd\u9645\u5316",children:"\u591a\u8bed\u8a00\u56fd\u9645\u5316"}),"\n",(0,s.jsx)(n.p,{children:"\u4e3a\u51cf\u5c11\u51b2\u7a81\uff0c\u51cf\u5c0f\u6bcf\u4e2a\u9875\u9762\u7684\u4f53\u79ef\uff0c\u591a\u8bed\u8a00\u5206\u4e3a\u591a\u4e2a\u5c42\u7ea7\uff0c\u4e00\u822c\u53ea\u9700\u8981\u7528\u5230\u81ea\u5df1\u9875\u9762\u5185\u7684locales\u76ee\u5f55\u5373\u53ef\u3002\u5176\u5b83\u5c42\u7ea7\u7684locales\u4f1a\u6839\u636e.env\u4e2d\u7684\u914d\u7f6e\uff0c\u81ea\u52a8\u5408\u5e76\u5230\u81ea\u5df1\u9875\u9762\u7684locales\u76ee\u5f55\u4e2d\u3002\u5e76\u5728\u8fdb\u5165\u9875\u9762\u65f6\u5728\u63a7\u5236\u53f0\u8f93\u51fa\u5408\u5e76\u540e\u7684\u591a\u8bed\u8a00\u914d\u7f6e\u5185\u5bb9\u4f9b\u53c2\u8003\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"vscode\u591a\u8bed\u8a00\u63d2\u4ef6",children:"vscode\u591a\u8bed\u8a00\u63d2\u4ef6"}),"\n",(0,s.jsx)(n.p,{children:"\u8bf7\u5b89\u88c5i18n Ally vscode\u63d2\u4ef6\uff0c\u5728\u4ee3\u7801\u4e2d\u67e5\u770b\u3001\u4fee\u6539\u5f53\u524d\u8bed\u8a00\u5185\u5bb9\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"\u591a\u8bed\u8a00\u914d\u7f6e\u6587\u4ef6\u7ed3\u6784",children:"\u591a\u8bed\u8a00\u914d\u7f6e\u6587\u4ef6\u7ed3\u6784"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"src/locales"}),"\n",(0,s.jsx)(n.li,{children:"src/platforms/mobile/locales"}),"\n",(0,s.jsx)(n.li,{children:"src/platforms/mobile/_native/locales"}),"\n",(0,s.jsx)(n.li,{children:"src/platforms/mobile/_browser/locales"}),"\n",(0,s.jsx)(n.li,{children:"src/platforms/mobile/modules/your-page/locales"}),"\n",(0,s.jsx)(n.li,{children:"src/platforms/pc/locales"}),"\n",(0,s.jsx)(n.li,{children:"src/platforms/pc/_native/locales"}),"\n",(0,s.jsx)(n.li,{children:"src/platforms/pc/_browser/locales"}),"\n",(0,s.jsx)(n.li,{children:"src/platforms/pc/modules/your-page/locales"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"\u5982\u4f55\u4fdd\u6301\u9879\u76ee\u4e0e\u6a21\u677f\u5de5\u7a0b\u7684\u540c\u6b65",children:"\u5982\u4f55\u4fdd\u6301\u9879\u76ee\u4e0e\u6a21\u677f\u5de5\u7a0b\u7684\u540c\u6b65"}),"\n",(0,s.jsx)(n.p,{children:"\u53c2\u8003\u521b\u5efa\u9879\u76ee\u8bf4\u660e\u4e2d\u7684\u547d\u4ee4\u521b\u5efa\u9879\u76ee\uff0c\u9ed8\u8ba4\u6bcf\u4e2a\u9879\u76ee\u4f1a\u521b\u5efa\u4e00\u4e2aup-stream\u5206\u652f\uff0c\u8ddf\u8e2a\u539f\u6a21\u677f\u5de5\u7a0b\u4e2d\u7684main\u5206\u652f\uff0c\u540e\u7eed\u6839\u636e\u9700\u8981cherry-pick\u5408\u5e76\u9700\u8981\u7684\u529f\u80fd\u5230\u81ea\u5df1\u7684\u9879\u76ee\u4e2d\u5373\u53ef\u3002"})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},1569:(e,n,r)=>{r.d(n,{A:()=>s});const s=r.p+"assets/images/standard-redux-app-slice-09339bba13ad3508bb2b41e683218460.png"},8355:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>o});var s=r(758);const a={},i=s.createContext(a);function t(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);